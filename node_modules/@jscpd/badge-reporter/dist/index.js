"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const badgen_1 = require("badgen");
const path_1 = require("path");
const fs_extra_1 = require("fs-extra");
const safe_1 = require("colors/safe");
class BadgeReporter {
    constructor(options) {
        this.options = options;
    }
    report(clones, statistic) {
        const badgeOptions = this.options.reportersOptions ? this.options.reportersOptions.badge || {} : {};
        if (this.options.output) {
            const badge = badgen_1.badgen(Object.assign({ color: this.getColor(statistic), status: this.getStatus(statistic), subject: 'Copy/Paste' }, badgeOptions));
            const path = badgeOptions.path ? badgeOptions.path : path_1.join(this.options.output, 'jscpd-badge.svg');
            fs_extra_1.ensureDirSync(this.options.output);
            fs_extra_1.writeFileSync(path, badge);
            console.log(safe_1.green(`Badge saved to ${path}`));
        }
    }
    getStatus(statistic) {
        return statistic ? statistic.total.percentage + '%' : 'N/A';
    }
    getColor(statistic) {
        if (this.options.threshold === undefined) {
            return 'grey';
        }
        return statistic.total.percentage < this.options.threshold ? 'green' : 'red';
    }
}
exports.default = BadgeReporter;
//# sourceMappingURL=index.js.map